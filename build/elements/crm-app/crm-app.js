/*
 * Original can be found at https://github.com/SanderRonde/CustomRightClickMenu 
 * This code may only be used under the MIT style license found in the LICENSE.txt file 
**/
"use strict";window.runOrAddAsCallback=function(a,b,c){window.app.settings?a.apply(b,c):window.app.addSettingsReadyCallback(a,b,c)},document.createElement("div").animate||(HTMLElement.prototype.animate=function(a,b){if(!a[1])return{play:function(){},reverse:function(){},effect:{target:this}};var c=this,d="forwards",e={play:function(){$(c).animate(a[~~("forwards"===d)],b&&b.duration||500,function(){e.onfinish&&e.onfinish.apply({effect:{target:c}})})},reverse:function(){d="backwards",this.play()},effect:{target:this}};return $(this).animate(a[1],b.duration,function(){e.onfinish&&e.onfinish.apply({effect:{target:c}})}),e},HTMLElement.prototype.animate.isJqueryFill=!0);var properties={settings:{type:Object,notify:!0},onSettingsReadyCallbacks:{type:Array,value:[]},crmType:Number,settingsJsonLength:{type:Number,notify:!0,value:0},globalExcludes:{type:Array,notify:!0,value:[]},versionUpdateTab:{type:Number,notify:!0,value:0,observer:"versionUpdateChanged"}},CA=function(){function a(){}return a.domListener=function(a){for(var b,c="data-on-"+a.type,d=this.listeners,e=0,f=a.path[e];!(b=f.getAttribute(c))&&e<a.path.length;)e++,f=a.path[e];if(b)if("prototype"!==b&&"parent"!==b&&d[b]){var g=this.listeners[b];g.bind(d)(a,a.detail)}else this._warn(this._logf("_createEventHandler","listener method "+b+" not defined"));else this._warn(this._logf("_createEventHandler","property "+c+" not defined"))},a._getPageTitle=function(){return location.href.indexOf("demo")>-1?"Demo, actual right-click menu does NOT work in demo":"Custom Right-Click Menu"},a._getString=function(a){return a||""},a._isOfType=function(a,b){return a.type===b},a._generateCodeOptionsArray=function(a){return"string"==typeof a?[]:Object.getOwnPropertyNames(a).map(function(b){return{key:b,value:JSON.parse(JSON.stringify(a[b]))}})},a._isOnlyGlobalExclude=function(){return 1===this.globalExcludes.length},a._isVersionUpdateTabX=function(a,b){return a===b},a._getUpdatedScriptString=function(a){return a?["Node ",a.name," was updated from version ",a.oldVersion," to version ",a.newVersion].join(""):"Please ignore"},a._getPermissionDescription=function(){return this.templates.getPermissionDescription},a._getNodeName=function(a){return window.app.nodesById[a].name},a._getNodeVersion=function(a){return window.app.nodesById[a].nodeInfo&&window.app.nodesById[a].nodeInfo.version||"1.0"},a._placeCommas=function(a){var b=this.reverseString(a.toString()).match(/[0-9]{1,3}/g);return this.reverseString(b.join(","))},a._getSettingsJsonLengthColor=function(){var a,b;return this.settingsJsonLength<=51200?(b=255,a=this.settingsJsonLength/51200*255):(a=255,b=255-(this.settingsJsonLength-51200)/51200*255),a=Math.floor(.7*a),b=Math.floor(.7*b),"color: rgb("+a+", "+b+", 0);"},a.findScriptsInSubtree=function(a,b){if("script"===a.type)b.push(a);else if(a.children)for(var c=0;c<a.children.length;c++)this.findScriptsInSubtree(a.children[c],b)},a.runDialogsForImportedScripts=function(a,b){var c=this;if(b[0]){var d=b.splice(0,1)[0];window.scriptEdit.openPermissionsDialog(d,function(){c.runDialogsForImportedScripts(a,b)})}else this.addImportedNodes(a)},a.addImportedNodes=function(a){var b=this;if(!a[0])return!1;var c=a.splice(0,1)[0];this.util.treeForEach(c,function(a){a.id=b.generateItemId(),a.nodeInfo.source="import"}),this.crm.add(c);var d=[];return this.findScriptsInSubtree(c,d),this.runDialogsForImportedScripts(a,d),!0},a.reverseString=function(a){return a.split("").reverse().join("")},a.requestPermissions=function(a,b){void 0===b&&(b=!1);var c,d,e=this,f=this.templates.getPermissions();for(c=0;c<a.length;c++)d=f.indexOf(a[c]),d===-1?(a.splice(d,1),c--):f.splice(d,1);chrome.storage.local.set({requestPermissions:a}),(a.length>0||b)&&chrome.permissions.getAll(function(b){function d(){var b,c;i.style.maxHeight="initial!important",i.style.top="initial!important",i.removeEventListener("iron-overlay-opened",d),$(".requestPermissionsShowBot").off("click").on("click",function(){b=$(this).parent().parent().children(".requestPermissionsPermissionBotCont")[0],c=$(this).find(".requestPermissionsSvg")[0],c.style.transform="rotate(90deg)"===c.style.transform||""===c.style.transform?"rotate(270deg)":"rotate(90deg)",b.animation?b.animation.reverse():b.animation=b.animate([{height:0},{height:b.scrollHeight+"px"}],{duration:250,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",fill:"both"})}),$("#requestPermissionsShowOther").off("click").on("click",function(){var a=this,b=$(this).parent().parent().parent().children("#requestPermissionsOther")[0];b.style.height&&"0px"!==b.style.height?$(b).animate({height:0},350,function(){a.children[0].style.display="block",a.children[1].style.display="none"}):$(b).animate({height:b.scrollHeight+"px"},350,function(){a.children[0].style.display="none",a.children[1].style.display="block"})});var e;$(".requestPermissionButton").off("click").on("click",function(){e=this.previousElementSibling.previousElementSibling.textContent;var a=this;if(this.checked)try{chrome.permissions.request({permissions:[e]},function(b){b?chrome.storage.local.get(function(a){var b=a.requestPermissions;b.splice(b.indexOf(e),1),chrome.storage.local.set({requestPermissions:b})}):a.checked=!1})}catch(a){chrome.storage.local.get(function(a){var b=a.requestPermissions;b.splice(b.indexOf(e),1),chrome.storage.local.set({requestPermissions:b})})}else chrome.permissions.remove({permissions:[e]},function(b){b||(a.checked=!0)})}),$("#requestPermissionsAcceptAll").off("click").on("click",function(){chrome.permissions.request({permissions:a},function(a){a&&(chrome.storage.local.set({requestPermissions:[]}),$(".requestPermissionButton.required").each(function(){this.checked=!0}))})})}var g=[];for(c=0;c<a.length;c++)g.push({name:a[c],description:e.templates.getPermissionDescription(a[c]),toggled:!1});var h=[];for(c=0;c<f.length;c++)h.push({name:f[c],description:e.templates.getPermissionDescription(f[c]),toggled:b.permissions.indexOf(f[c])>-1});var i,j=$("#requestPermissionsOther")[0],k=window.setInterval(function(){try{var a=window.doc.requestPermissionsCenterer;i=a.$.content.children[0],i.open&&(window.clearInterval(k),$("#requestedPermissionsTemplate")[0].items=g,$("#requestedPermissionsOtherTemplate")[0].items=h,i.addEventListener("iron-overlay-opened",d),setTimeout(function(){var a=$("#requestedPermissionsCont")[0],b=$("#requestPermissionsAcceptAll")[0],c=$(".requestPermissionsType")[0];0===g.length?(a.style.display="none",j.style.height=31*h.length+"px",b.style.display="none",c.style.display="none"):(a.style.display="block",j.style.height="0",b.style.display="block",c.style.display="block"),i.open()},0))}catch(a){}},100)})},a.transferCRMFromOld=function(a,b,c){return void 0===b&&(b=localStorage),void 0===c&&(c=2),this.transferFromOld.transferCRMFromOld(a,b,c)},a.initCodeOptions=function(a){var b=this;this.$.codeSettingsDialog.item=a,this.$.codeSettingsTitle.innerText="Changing the options for "+a.name,this.$.codeSettingsRepeat.items=this._generateCodeOptionsArray(a.value.options),this.$.codeSettingsNoItems.if=0===this.$.codeSettingsRepeat.items.length,this.async(function(){b.$.codeSettingsDialog.fit(),Array.prototype.slice.apply(b.$.codeSettingsDialog.querySelectorAll("paper-dropdown-menu")).forEach(function(a){a.init()}),b.$.codeSettingsDialog.open()},100)},a.tryEditorLoaded=function(a){a.display.wrapper.classList.add("try-editor-codemirror"),a.refresh()},a.versionUpdateChanged=function(){if(this._isVersionUpdateTabX(this.versionUpdateTab,1)){var a=this.$.versionUpdateDialog;a.editor||(a.editor=window.CodeMirror(this.$.tryOutEditor,{lineNumbers:!0,value:"//some javascript code\nvar body = document.getElementById('body');\nbody.style.color = 'red';\n\n",scrollbarStyle:"simple",lineWrapping:!0,mode:"javascript",readOnly:!1,foldGutter:!0,theme:"dark",indentUnit:window.app.settings.editor.tabSize,indentWithTabs:window.app.settings.editor.useTabs,gutters:["CodeMirror-lint-markers","CodeMirror-foldgutter"],lint:window.CodeMirror.lint.javascript,messageTryEditor:!0,undoDepth:500}))}},a.generateItemId=function(){return this.latestId=this.latestId||0,this.latestId++,this.settings&&(this.settings.latestId=this.latestId,window.app.upload()),this.latestId},a.toggleShrinkTitleRibbon=function(){var a=window.innerHeight,b=$("#settingsContainer");window.app.storageLocal.shrinkTitleRibbon?($(window.doc.editorTitleRibbon).animate({fontSize:"100%"},250),$(window.doc.editorCurrentScriptTitle).animate({paddingTop:"4px",paddingBottom:"4px"},250),b.animate({height:a-50},250,function(){b[0].style.height="calc(100vh - 66px)"}),window.doc.shrinkTitleRibbonButton.style.transform="rotate(270deg)"):($(window.doc.editorTitleRibbon).animate({fontSize:"40%"},250),$(window.doc.editorCurrentScriptTitle).animate({paddingTop:0,paddingBottom:0},250),b.animate({height:a-18},250,function(){b[0].style.height="calc(100vh - 29px)"}),window.doc.shrinkTitleRibbonButton.style.transform="rotate(90deg)"),window.app.storageLocal.shrinkTitleRibbon=!window.app.storageLocal.shrinkTitleRibbon,chrome.storage.local.set({shrinkTitleRibbon:window.app.storageLocal.shrinkTitleRibbon})},a.addSettingsReadyCallback=function(a,b,c){this.onSettingsReadyCallbacks.push({callback:a,thisElement:b,params:c})},a.upload=function(a){void 0===a&&(a=!1),this.uploading.upload(a)},a.updateEditorZoom=function(){var a=document.getElementById("editorZoomStyle");a&&a.remove();var b=document.createElement("style");b.id="editorZoomStyle",b.innerText=".CodeMirror, .CodeMirror-focused {\n\t\t\tfont-size: "+1.25*~~window.app.settings.editor.zoom+"%!important;\n\t\t}",document.head.appendChild(b),$(".CodeMirror").each(function(){this.CodeMirror.refresh()});var c=window.scriptEdit&&window.scriptEdit.active?window.scriptEdit.editor:window.stylesheetEdit&&window.stylesheetEdit.active?window.stylesheetEdit.editor:null;c&&window.colorFunction&&window.colorFunction.func({from:{line:0},to:{line:c.lineCount()}},c)},a.setLocal=function(a,b){var c=(e={},e[a]=b,e),d=this;chrome.storage.local.set(c),chrome.storage.local.get(function(b){d.storageLocal=b,"CRMOnPage"===a&&window.doc.editCRMInRM.setCheckboxDisabledValue&&window.doc.editCRMInRM.setCheckboxDisabledValue(!b.CRMOnPage),d.upload()});var e},a.refreshPage=function(){function a(a){a(),this.setup.initCheckboxes.apply(this,[window.app.storageLocal]),Array.prototype.slice.apply(document.querySelectorAll("default-link")).forEach(function(a){a.reset()}),window.doc.URISchemeFilePath.value="C:\\files\\my_file.exe",window.doc.URISchemeFilePath.querySelector("input").value="C:\\files\\my_file.exe",window.doc.URISchemeSchemeName.value="myscheme",window.doc.URISchemeSchemeName.querySelector("input").value="myscheme",Array.prototype.slice.apply(document.querySelectorAll("paper-dialog")).forEach(function(a){a.opened&&a.close()}),this.upload(!0)}var b=this;if(window.app.item){var c=window[window.app.item.type+"Edit"];c&&c.cancel()}window.app.item=null,window.app.settings=window.app.storageLocal=null,window.Storages.loadStorages(function(){b.setup.setupStorages(a.bind(b))})},a.ready=function(){var a=this;window.app=this,window.doc=window.app.$,chrome.runtime.onInstalled.addListener(function(b){"update"===b.reason&&(a.$.messageToast.text="Extension has been updated to version "+chrome.runtime.getManifest().version,a.$.messageToast.show())}),"undefined"==typeof localStorage&&chrome.runtime.onMessage.addListener(function(b){"idUpdate"===b.type&&(a.latestId=b.latestId)});var b=0;document.body.addEventListener("keydown",function(c){"Control"===c.key&&(b++,window.setTimeout(function(){b>=3?(a.listeners._toggleBugReportingTool(),b=0):b>0&&b--},800))}),this.setup.setupLoadingBar(function(b){a.setup.setupStorages.apply(a.setup,[b])}),this.show=!1},a}();CA.is="crm-app",CA._log=[],CA.show=!1,CA.item=null,CA.latestId=-1,CA.nodesById={},CA.jsLintGlobals=[],CA.properties=properties,CA.transferFromOld=function(){function a(){}return a.backupLocalStorage=function(){if("undefined"!=typeof localStorage&&("undefined"!=typeof window.indexedDB||"undefined"!=typeof window.webkitIndexedDB)){var a=JSON.stringify(localStorage),b=window.indexedDB||window.webkitIndexedDB,c=b.open("localStorageBackup",1);c.onerror=function(){console.log("Error backing up localStorage data")},c.onupgradeneeded=function(b){var c=b.target.result,d=c.createObjectStore("data",{keyPath:"id"});d.add({id:0,data:a})}}},a.parseOldCRMNode=function(a,b,c){var d={},e=a.split("%123"),f=e[0],g=e[1].toLowerCase(),h=e[2];switch(g){case"link":var i=void 0;i=h.indexOf(", ")>-1?h.split(", "):h.split(","),d=this.parent().templates.getDefaultLinkNode({name:f,id:this.parent().generateItemId(),value:i.map(function(a){return{newTab:b,url:a}})});break;case"divider":d=this.parent().templates.getDefaultDividerNode({name:f,id:this.parent().generateItemId()});break;case"menu":d=this.parent().templates.getDefaultMenuNode({name:f,id:this.parent().generateItemId(),children:h});break;case"script":var j=h.split("%124"),k=j[0],l=j[1],m=void 0,n=k+"";n+""!="0"&&n+""!="2"&&(m=n.split("1,")[1].split(","),m=m.map(function(a){return{not:!1,url:a.trim()}}).filter(function(a){return""!==a.url}),k="2");var o=this.parent().generateItemId();d=this.parent().templates.getDefaultScriptNode({name:f,id:o,triggers:m||[],value:{launchMode:parseInt(k,10),updateNotice:!0,oldScript:l,script:this.parent().legacyScriptReplace.convertScriptFromLegacy(l,o,c)}})}return d},a.assignParents=function(a,b,c,d){for(;0!==d&&b[c.index];c.index++,d--){var e=b[c.index];if("menu"===e.type){var f=~~e.children;e.children=[],c.index++,this.assignParents(e.children,b,c,f),c.index--}a.push(e)}},a.transferCRMFromOld=function(a,b,c){this.backupLocalStorage();var d,e=parseInt(b.getItem("numberofrows"),10)+1,f=[];for(d=1;d<e;d++)f.push(this.parseOldCRMNode(b.getItem(d),a,c));var g=[];return this.assignParents(g,f,{index:0},f.length),g},a.parent=function(){return window.app},a}(),CA.setup=function(){function a(){}return a.restoreUnsavedInstances=function(a,b){void 0===b&&(b=0);var c=this;if(b=b+1||0,b<5)if(window.CodeMirror){var d=c.parent().nodesById[a.id],e="script"===d.type?"main"===a.mode?d.value.script:d.value.backgroundScript:d.value.stylesheet;c.parent().listeners.iconSwitch(null,a.crmType),$(".keepChangesButton").on("click",function(){"script"===d.type?d.value["main"===a.mode?"script":"backgroundScript"]=a.val:d.value.stylesheet=a.val,window.app.upload(),chrome.storage.local.set({editing:null}),window.setTimeout(function(){window.doc.restoreChangesOldCodeCont.innerHTML="",window.doc.restoreChangeUnsaveddCodeCont.innerHTML=""},500)}),$(".restoreChangesBack").on("click",function(){window.doc.restoreChangesOldCode.style.display="none",window.doc.restoreChangesUnsavedCode.style.display="none",window.doc.restoreChangesMain.style.display="block",window.doc.restoreChangesDialog.fit()}),$(".discardButton").on("click",function(){chrome.storage.local.set({editing:null}),window.setTimeout(function(){window.doc.restoreChangesOldCodeCont.innerHTML="",window.doc.restoreChangeUnsaveddCodeCont.innerHTML=""},500)}),window.doc.restoreChangeUnsaveddCodeCont.innerHTML="",window.doc.restoreChangesOldCodeCont.innerHTML="";var f=window.CodeMirror(window.doc.restoreChangesOldCodeCont,{lineNumbers:!0,value:e,scrollbarStyle:"simple",lineWrapping:!0,readOnly:"nocursor",theme:"dark"===window.app.settings.editor.theme?"dark":"default",indentUnit:window.app.settings.editor.tabSize,indentWithTabs:window.app.settings.editor.useTabs}),g=window.CodeMirror(window.doc.restoreChangeUnsaveddCodeCont,{lineNumbers:!0,value:a.val,scrollbarStyle:"simple",lineWrapping:!0,readOnly:"nocursor",theme:"dark"===window.app.settings.editor.theme?"dark":"default",indentUnit:window.app.settings.editor.tabSize,indentWithTabs:window.app.settings.editor.useTabs});window.doc.restoreChangesShowOld.addEventListener("click",function(){window.doc.restoreChangesMain.style.display="none",window.doc.restoreChangesUnsavedCode.style.display="none",window.doc.restoreChangesOldCode.style.display="flex",window.doc.restoreChangesDialog.fit(),f.refresh()}),window.doc.restoreChangesShowUnsaved.addEventListener("click",function(){window.doc.restoreChangesMain.style.display="none",window.doc.restoreChangesOldCode.style.display="none",window.doc.restoreChangesUnsavedCode.style.display="flex",window.doc.restoreChangesDialog.fit(),g.refresh()});var h=function(a){$(a).find(".item")[0].animate([{opacity:1},{opacity:.6}],{duration:250,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"}).onfinish=function(){this.effect.target.style.opacity="0.6",window.doc.restoreChangesDialog.open(),$(".pageCont").animate({backgroundColor:"white"},200),$(".crmType").each(function(){this.classList.remove("dim")}),$("edit-crm-item").find(".item").animate({opacity:1},200,function(){document.body.style.pointerEvents="all"})}},i=c.parent().nodesById[a.id].path,j=function(){document.body.style.pointerEvents="none";var a=$("#mainCont").children("div"),b=$(a[i.length-1+2]),c=$(b.children("paper-material")[0]),d=c.children(".CRMEditColumn")[0],e=$(d).children("edit-crm-item"),f=e[i[i.length-1]];$(f).find(".item")[0]?($(f).find(".item")[0].animate([{opacity:.6},{opacity:1}],{duration:250,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"}).onfinish=function(){this.effect.target.style.opacity="1"},setTimeout(function(){h(f)},2e3)):(window.doc.restoreChangesDialog.open(),$(".pageCont").animate({backgroundColor:"white"},200),$(".crmType").each(function(){this.classList.remove("dim")}),$("edit-crm-item").find(".item").animate({opacity:1},200,function(){document.body.style.pointerEvents="all"}))};window.doc.highlightChangedScript.addEventListener("click",function(){window.doc.restoreChangesDialog.close(),$(".pageCont")[0].style.backgroundColor="rgba(0,0,0,0.4)",$("edit-crm-item").find(".item").css("opacity",.6),$(".crmType").each(function(){this.classList.add("dim")}),setTimeout(function(){if(1===i.length)j();else{for(var a=!0,b=1;b<i.length;b++)if(window.app.editCRM.crm[b].indent.length!==i[b-1]){a=!1;break}if(a)j();else{var c=JSON.parse(JSON.stringify(i.length));c.pop(),window.app.editCRM.build(c),setTimeout(j,700)}}},500)});try{window.doc.restoreChangesDialog.open()}catch(d){c.restoreUnsavedInstances(a,b+1)}}else setTimeout(function(){c.restoreUnsavedInstances(a,b)},500)},a.bindListeners=function(){var a=window.doc.addLibraryUrlInput,b=window.doc.addLibraryManualInput;window.doc.addLibraryUrlOption.addEventListener("change",function(){b.style.display="none",a.style.display="block"}),window.doc.addLibraryManualOption.addEventListener("change",function(){a.style.display="none",b.style.display="block"}),$("#addLibraryDialog").on("iron-overlay-closed",function(){$(this).find("#addLibraryButton, #addLibraryConfirmAddition, #addLibraryDenyConfirmation").off("click")})},a.setupStorages=function(a){var b=this.parent();chrome.storage.local.get(function(c){a(function(){function a(a){b.settings=a,b.settingsCopy=JSON.parse(JSON.stringify(a));for(var d=0;d<b.onSettingsReadyCallbacks.length;d++)b.onSettingsReadyCallbacks[d].callback.apply(b.onSettingsReadyCallbacks[d].thisElement,b.onSettingsReadyCallbacks[d].params);b.updateEditorZoom(),b.setup.orderNodesById(a.crm),b.pageDemo.create(),b.setup.buildNodePaths(a.crm,[]),b.settings.latestId?b.latestId=a.latestId:b.latestId=0,~~/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1].split(".")[0]<=34&&window.doc.CRMOnPage.setCheckboxDisabledValue(!0),window.doc.editCRMInRM.setCheckboxDisabledValue(!c.CRMOnPage)}if(Array.prototype.slice.apply(document.querySelectorAll("paper-toggle-option")).forEach(function(a){a.init(c)}),b.setup.bindListeners(),delete c.nodeStorage,c.requestPermissions&&c.requestPermissions.length>0&&b.requestPermissions(c.requestPermissions),c.editing){var d=c.editing;setTimeout(function(){var a=b.nodesById[d.id],c="script"===a.type?a.value.script:a.value.stylesheet;c.trim()!==d.val.trim()?b.setup.restoreUnsavedInstances(d):chrome.storage.local.set({editing:null})},2500)}if(void 0!==c.selectedCrmType?(b.crmType=c.selectedCrmType,b.setup.switchToIcons(c.selectedCrmType)):(chrome.storage.local.set({selectedCrmType:0}),b.crmType=0,b.setup.switchToIcons(0)),c.jsLintGlobals?b.jsLintGlobals=c.jsLintGlobals:(b.jsLintGlobals=["window","$","jQuery","crmapi"],chrome.storage.local.set({jsLintGlobals:b.jsLintGlobals})),c.globalExcludes&&c.globalExcludes.length>1?b.globalExcludes=c.globalExcludes:(b.globalExcludes=[""],chrome.storage.local.set({globalExcludes:b.globalExcludes})),c.addedPermissions&&c.addedPermissions.length>0&&window.setTimeout(function(){window.doc.addedPermissionsTabContainer.tab=0,window.doc.addedPermissionsTabContainer.maxTabs=c.addedPermissions.length,window.doc.addedPermissionsTabRepeater.items=c.addedPermissions,1===c.addedPermissions.length?window.doc.addedPermissionNextButton.querySelector(".next").style.display="none":window.doc.addedPermissionNextButton.querySelector(".close").style.display="none",window.doc.addedPermissionPrevButton.style.display="none",window.doc.addedPermissionsTabRepeater.render(),window.doc.addedPermissionsDialog.open(),chrome.storage.local.set({addedPermissions:null})},2500),c.updatedScripts&&c.updatedScripts.length>0&&(b.$.scriptUpdatesToast.text=b._getUpdatedScriptString(c.updatedScripts[0]),b.$.scriptUpdatesToast.scripts=c.updatedScripts,b.$.scriptUpdatesToast.index=0,b.$.scriptUpdatesToast.show(),c.updatedScripts.length>1?b.$.nextScriptUpdateButton.style.display="inline":b.$.nextScriptUpdateButton.style.display="none",chrome.storage.local.set({updatedScripts:[]}),c.updatedScripts=[]),c.settingsVersionData&&c.settingsVersionData.wasUpdated){var e=c.settingsVersionData;e.wasUpdated=!1,chrome.storage.local.set({settingsVersionData:e});var f=window.doc.updatedSettingsToast;f.text="Settings were updated to those on "+new Date(e.latest.date).toLocaleDateString(),f.show()}c.isTransfer&&(chrome.storage.local.set({isTransfer:!1}),window.doc.versionUpdateDialog.open()),b.storageLocal=c,b.storageLocalCopy=JSON.parse(JSON.stringify(c)),c.useStorageSync?chrome.storage.sync.get(function(d){var e=d.indexes;if(e){var f=[];e.forEach(function(a){f.push(d[a])});var g=f.join("");b.settingsJsonLength=g.length;var h=JSON.parse(g);a(h)}else chrome.storage.local.set({useStorageSync:!1}),a(c.settings)}):(b.settingsJsonLength=JSON.stringify(c.settings||{}).length,c.settings?a(c.settings):(chrome.storage.local.set({useStorageSync:!0}),chrome.storage.sync.get(function(c){var d=c.indexes,e=[];d.forEach(function(a){e.push(c[a])});var f=e.join("");b.settingsJsonLength=f.length;var g=JSON.parse(f);a(g)})))})})},a.animateLoadingBar=function(a,b){var c=this,d="scaleX("+a.lastReachedProgress+")",e="scaleX("+b+")";return a.max===a.lastReachedProgress||a.toReach>=1?void(a.progressBar.animate([{transform:d,WebkitTransform:d},{transform:e,WebkitTransform:e}],{duration:200,easing:"linear"}).onfinish=function(){a.lastReachedProgress=b,a.isAnimating=!1,a.progressBar.style.transform=e,a.progressBar.style.WebkitTransform=e}):void(a.progressBar.animate.isJqueryFill?(a.progressBar.style.transform=e,a.progressBar.style.WebkitTransform=e):a.isAnimating?(a.toReach=b,a.shouldAnimate=!0):(a.isAnimating=!0,a.progressBar.animate([{transform:d,WebkitTransform:d},{transform:e,WebkitTransform:e}],{duration:200,easing:"linear"}).onfinish=function(){a.lastReachedProgress=b,a.isAnimating=!1,a.progressBar.style.transform=e,a.progressBar.style.WebkitTransform=e,c.animateLoadingBar(a,a.toReach)}))},a.setupLoadingBar=function(a){var b=null;a(function(a){b=a});var c=this,d=62,e={lastReachedProgress:0,progressBar:document.getElementById("splashScreenProgressBarLoader"),toReach:0,isAnimating:!1,shouldAnimate:!1,max:d},f=Polymer.telemetry.registrations.length,g=Array.prototype.slice.apply(Polymer.telemetry.registrations);g.push=function(a){Array.prototype.push.call(g,a),f++;var h=Math.round(f/d*100)/100;c.animateLoadingBar(e,h),f===d&&window.setTimeout(function(){b&&b(),window.setTimeout(function(){document.documentElement.classList.remove("elementsLoading"),window.lastError||location.hash.indexOf("noClear")!==-1||console.clear(),window.setTimeout(function(){window.polymerElementsLoaded=!0,document.getElementById("splashScreen").style.display="none"},500),console.log("%cHey there, if you're interested in how this extension works check out the github repository over at https://github.com/SanderRonde/CustomRightClickMenu","font-size:120%;font-weight:bold;")},200),window.CRMLoaded=window.CRMLoaded||{listener:null,register:function(a){a()}},window.CRMLoaded.listener&&window.CRMLoaded.listener()},25)},Polymer.telemetry.registrations=g},a.initCheckboxes=function(a){var b=this;window.doc.editCRMInRM.setCheckboxDisabledValue?(window.doc.editCRMInRM.setCheckboxDisabledValue&&window.doc.editCRMInRM.setCheckboxDisabledValue(!1),Array.prototype.slice.apply(document.querySelectorAll("paper-toggle-option")).forEach(function(b){b.init&&b.init(a)})):window.setTimeout(function(){b.initCheckboxes.apply(b,[a])},1e3)},a.buildNodePaths=function(a,b){for(var c=0;c<a.length;c++){var d=b.concat([c]),e=a[c];e.path=d,e.children&&this.buildNodePaths(e.children,d)}},a.orderNodesById=function(a){for(var b=0;b<a.length;b++){var c=a[b];this.parent().nodesById[c.id]=c,c.children&&this.orderNodesById(c.children)}},a.switchToIcons=function(a){var b,c,d=document.querySelectorAll(".crmType");for(b=0;b<6;b++)if(a===b){c=d[b],c.style.boxShadow="inset 0 5px 10px rgba(0,0,0,0.4)",c.classList.add("toggled");var e=document.createElement("div");5===a?e.classList.add("crmTypeShadowMagicElementRight"):e.classList.add("crmTypeShadowMagicElement"),c.appendChild(e)}this.parent().crmType=a,this.parent().fire("crmTypeChanged",{})},a.parent=function(){return window.app},a}(),CA.uploading=function(){function a(){}return a.areValuesDifferent=function(a,b){var c=Array.isArray(a),d=Array.isArray(b),e="object"==typeof a,f="object"==typeof b;if(e){if(!f)return!0;if(c){if(!d)return!0;if(!this.parent().util.compareArray(a,b))return!0}else{if(d)return!0;if(!this.parent().util.compareObj(a,b))return!0}}else if(a!==b)return!0;return!1},a.getObjDifferences=function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&this.areValuesDifferent(a[d],b[d])&&c.push({oldValue:b[d],newValue:a[d],key:d});return c.length>0},a.upload=function(a){var b=[],c=this.parent().storageLocal,d=a?{}:this.parent().storageLocalCopy,e=[],f=this.parent().settings,g=a?{}:this.parent().settingsCopy,h=this.getObjDifferences(c,d,b),i=this.getObjDifferences(f,g,e);(h||i)&&chrome.runtime.sendMessage({type:"updateStorage",data:{type:"optionsPage",localChanges:h&&b,settingsChanges:i&&e}}),this.parent().pageDemo.create()},a.parent=function(){return window.app},a}(),CA.legacyScriptReplace=(_a=function(){function a(){}return a.generateScriptUpgradeErrorHandler=function(a){return function(b,c,d){chrome.storage.local.get(function(e){if(!e.upgradeErrors){var f={};f[a]={oldScript:b,newScript:c,generalError:d},e.upgradeErrors=f,window.app.storageLocal.upgradeErrors=f}e.upgradeErrors[a]=window.app.storageLocal.upgradeErrors[a]={oldScript:b,newScript:c,generalError:d},chrome.storage.local.set({upgradeErrors:e.upgradeErrors})})}},a.convertScriptFromLegacy=function(a,b,c){var d=!1,e=a.indexOf("/*execute locally*/");e!==-1&&(a=a.replace("/*execute locally*/\n",""),e===a.indexOf("/*execute locally*/")&&(a=a.replace("/*execute locally*/","")),d=!0);try{switch(c){case 0:a=this.chromeCallsReplace.replace(a,this.generateScriptUpgradeErrorHandler(b));break;case 1:a=d?this.localStorageReplace.replaceCalls(a.split("\n")):a;break;case 2:var f=d?this.localStorageReplace.replaceCalls(a.split("\n")):a;a=this.chromeCallsReplace.replace(f,this.generateScriptUpgradeErrorHandler(b))}}catch(b){return a}return a},a}(),_a.localStorageReplace=function(){function a(){}return a.findExpression=function(a,b,c,d){if(!a)return!1;switch(a.type){case"Identifier":if(a.name===c)return d(b,a),!0;break;case"VariableDeclaration":for(var e=0;e<a.declarations.length;e++){var f=a.declarations[e];if(f.init&&this.findExpression(f.init,b,c,d))return!0}break;case"MemberExpression":return b.isObj=!0,!!this.findExpression(a.object,b,c,d)||(b.siblingExpr=a.object,b.isObj=!1,this.findExpression(a.property,b,c,d));case"CallExpression":if(a.arguments&&a.arguments.length>0)for(var e=0;e<a.arguments.length;e++)if(this.findExpression(a.arguments[e],b,c,d))return!0;if(a.callee)return this.findExpression(a.callee,b,c,d);break;case"AssignmentExpression":return this.findExpression(a.right,b,c,d);case"FunctionExpression":case"FunctionDeclaration":for(var e=0;e<a.body.body.length;e++)if(this.findExpression(a.body.body[e],b,c,d))return!0;break;case"ExpressionStatement":return this.findExpression(a.expression,b,c,d);case"SequenceExpression":for(var e=0;e<a.expressions.length;e++)if(this.findExpression(a.expressions[e],b,c,d))return!0;break;case"UnaryExpression":case"ConditionalExpression":return!!this.findExpression(a.consequent,b,c,d)||this.findExpression(a.alternate,b,c,d);case"IfStatement":if(this.findExpression(a.consequent,b,c,d))return!0;if(a.alternate)return this.findExpression(a.alternate,b,c,d);break;case"LogicalExpression":case"BinaryExpression":return!!this.findExpression(a.left,b,c,d)||this.findExpression(a.right,b,c,d);case"BlockStatement":for(var e=0;e<a.body.length;e++)if(this.findExpression(a.body[e],b,c,d))return!0;break;case"ReturnStatement":return this.findExpression(a.argument,b,c,d);case"ObjectExpressions":for(var e=0;e<a.properties.length;e++)if(this.findExpression(a.properties[e].value,b,c,d))return!0}return!1},a.getLineSeperators=function(a){for(var b=0,c=[],d=0;d<a.length;d++)c.push({start:b,end:b+=a[d].length+1});return c},a.replaceCalls=function(a){var b=new window.TernFile("[doc]");b.text=a.join("\n");var c=new window.CodeMirror.TernServer({defs:[window.ecma5,window.ecma6,window.browserDefs]});window.tern.withContext(c.cx,function(){b.ast=window.tern.parse(b.text,c.passes,{directSourceFile:b,allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,ecmaVersion:c.ecmaVersion})});for(var d=b.ast.body,e=b.text,f={lines:a,lineSeperators:this.getLineSeperators(a),script:e},g=0;g<d.length;g++){var h=d[g];if(this.findExpression(h,f,"localStorage",function(a,b){a.script=a.script.slice(0,b.start)+"localStorageProxy"+a.script.slice(b.end),a.lines=a.script.split("\n")}))return this.replaceCalls(f.lines)}return f.script},a}(),_a.chromeCallsReplace=function(){function a(){}return a.isProperty=function(a,b){return a===b||a.replace(/['|"|`]/g,"")===b},a.getCallLines=function(a,b,c){for(var d={},e=0;e<a.length;e++){var f=a[e];if(f.start<=b&&(d.from={index:f.start,line:e}),f.end>=c){d.to={index:f.end,line:e};break}}return d},a.getFunctionCallExpressions=function(a){for(var b=a.parentExpressions.length-1,c=a.parentExpressions[b];c&&"CallExpression"!==c.type;)c=a.parentExpressions[--b];return a.parentExpressions[b]},a.getChromeAPI=function(a,b){b.functionCall=b.functionCall.map(function(a){return a.replace(/['|"|`]/g,"")});var c=b.functionCall;c=c.reverse(),"chrome"===c[0]&&c.splice(0,1);var d=a.callee.end,e=a.end,f=b.persistent.script.slice(d,e);return{call:c.join("."),args:f}},a.getLineIndexFromTotalIndex=function(a,b,c){for(var d=0;d<b;d++)c-=a[d].length+1;return c},a.replaceChromeFunction=function(a,b,c){if(!a.isReturn||a.isValidReturn){for(var d,e=a.persistent.lines,f=this.getChromeAPI(b,a),g=a.persistent.lines[c.from.line],h=this.getLineIndexFromTotalIndex(a.persistent.lines,c.from.line,a.returnExpr&&a.returnExpr.start||b.callee.start),i=this.getLineIndexFromTotalIndex(a.persistent.lines,c.from.line,b.callee.end),j=g.slice(0,h)+("window.crmAPI.chrome('"+f.call+"')"),k=null;" "===j[k=j.length-1];)j=j.slice(0,k);if(";"===j[k=j.length-1]&&(j=j.slice(0,k)),"()"!==f.args){var l=f.args.split("\n");for(j+=l[0],d=1;d<l.length;d++)e[c.from.line+d]=l[d]}if(a.isReturn){for(var m=g.slice(i+f.args.split("\n")[0].length);0===m.indexOf(";");)m=m.slice(1);j+=".return(function("+a.returnName+") {"+m;for(var n=!0,o=0,p=0;p<a.persistent.lines.length;p++){if(0===a.persistent.lines[p].indexOf("\t")){n=!0;break}if(0===a.persistent.lines[p].indexOf("  ")){
for(var q=a.persistent.lines[p].split(" "),r=0;r<q.length&&" "===q[r];r++)o++;n=!1;break}}var s;n?s="\t":(s=[],s[o]=" ",s=s.join(" "));var t=null,u=null;for(d=a.parentExpressions.length-1;null===t&&0!==d;d--)if("BlockStatement"===a.parentExpressions[d].type||"FunctionExpression"===a.parentExpressions[d].type&&"BlockStatement"===a.parentExpressions[d].body.type){for(t=this.getLineIndexFromTotalIndex(a.persistent.lines,c.from.line,a.parentExpressions[d].end),u=0;t>0;)t=this.getLineIndexFromTotalIndex(a.persistent.lines,c.from.line+ ++u,a.parentExpressions[d].end);t=this.getLineIndexFromTotalIndex(a.persistent.lines,c.from.line+(u-1),a.parentExpressions[d].end)}null===u&&(u=e.length-c.from.line+1);for(var v=0,w=e[c.from.line];0===w.indexOf(s);)w=w.replace(s,""),v++;var x,y=[];y[v]="";var z=y.join(s)+"}).send();",A=a.persistent.lines.length+1;for(d=c.from.line;d<c.from.line+(u-1);d++)e[d]=s+e[d];for(d=c.from.line+(u-1);d<A;d++)x=e[d],e[d]=z,z=x}else e[c.from.line+(d-1)]=e[c.from.line+(d-1)]+".send();",1===d&&(j+=".send();");e[c.from.line]=j}},a.callsChromeFunction=function(a,b,c){if(b.parentExpressions.push(a),a.arguments&&a.arguments.length>0)for(var d=0;d<a.arguments.length;d++)if(this.findChromeExpression(a.arguments[d],this.removeObjLink(b),c))return!0;if("MemberExpression"!==a.type)return this.findChromeExpression(a,this.removeObjLink(b),c);if(a.property&&(b.functionCall=b.functionCall||[],b.functionCall.push(a.property.name||a.property.raw)),a.object&&a.object.name){var e=this.isProperty(a.object.name,"window")&&this.isProperty(a.property.name||a.property.raw,"chrome");if(e||this.isProperty(a.object.name,"chrome")){b.expression=a;var f=this.getFunctionCallExpressions(b),g=this.getCallLines(b.persistent.lineSeperators,f.start,f.end);return b.isReturn&&!b.isValidReturn?(g.from.index=this.getLineIndexFromTotalIndex(b.persistent.lines,g.from.line,g.from.index),g.to.index=this.getLineIndexFromTotalIndex(b.persistent.lines,g.to.line,g.to.index),c(g,b.persistent.passes),!1):(b.persistent.diagnostic||this.replaceChromeFunction(b,f,g),!0)}}else if(a.object)return this.callsChromeFunction(a.object,b,c);return!1},a.removeObjLink=function(a){var b=a.parentExpressions||[],c={};for(var d in a)a.hasOwnProperty(d)&&"parentExpressions"!==d&&"persistent"!==d&&(c[d]=a[d]);for(var e=[],f=0;f<b.length;f++)e.push(b[f]);return c.persistent=a.persistent,c.parentExpressions=e,c},a.findChromeExpression=function(a,b,c){switch(b.parentExpressions=b.parentExpressions||[],b.parentExpressions.push(a),a.type){case"VariableDeclaration":b.isValidReturn=1===a.declarations.length;for(var d=0;d<a.declarations.length;d++){var e=a.declarations[d];if(e.init){var f=this.removeObjLink(b),g=e.id.name;if(f.isReturn=!0,f.returnExpr=a,f.returnName=g,this.findChromeExpression(e.init,f,c))return!0}}break;case"CallExpression":case"MemberExpression":var h=[];if(a.arguments&&a.arguments.length>0)for(var d=0;d<a.arguments.length;d++)if("MemberExpression"!==a.arguments[d].type&&"CallExpression"!==a.arguments[d].type)h.push(a.arguments[d]);else if(this.findChromeExpression(a.arguments[d],this.removeObjLink(b),c))return!0;if(b.functionCall=[],a.callee&&this.callsChromeFunction(a.callee,b,c))return!0;for(var d=0;d<h.length;d++)if(this.findChromeExpression(h[d],this.removeObjLink(b),c))return!0;break;case"AssignmentExpression":return b.isReturn=!0,b.returnExpr=a,b.returnName=a.left.name,this.findChromeExpression(a.right,b,c);case"FunctionExpression":case"FunctionDeclaration":b.isReturn=!1;for(var d=0;d<a.body.body.length;d++)if(this.findChromeExpression(a.body.body[d],this.removeObjLink(b),c))return!0;break;case"ExpressionStatement":return this.findChromeExpression(a.expression,b,c);case"SequenceExpression":b.isReturn=!1;for(var i=a.expressions.length-1,d=0;d<a.expressions.length;d++)if(d===i&&(b.isReturn=!0),this.findChromeExpression(a.expressions[d],this.removeObjLink(b),c))return!0;break;case"UnaryExpression":case"ConditionalExpression":if(b.isValidReturn=!1,b.isReturn=!0,this.findChromeExpression(a.consequent,this.removeObjLink(b),c))return!0;if(this.findChromeExpression(a.alternate,this.removeObjLink(b),c))return!0;break;case"IfStatement":if(b.isReturn=!1,this.findChromeExpression(a.consequent,this.removeObjLink(b),c))return!0;if(a.alternate&&this.findChromeExpression(a.alternate,this.removeObjLink(b),c))return!0;break;case"LogicalExpression":case"BinaryExpression":if(b.isReturn=!0,b.isValidReturn=!1,this.findChromeExpression(a.left,this.removeObjLink(b),c))return!0;if(this.findChromeExpression(a.right,this.removeObjLink(b),c))return!0;break;case"BlockStatement":b.isReturn=!1;for(var d=0;d<a.body.length;d++)if(this.findChromeExpression(a.body[d],this.removeObjLink(b),c))return!0;break;case"ReturnStatement":return b.isReturn=!0,b.returnExpr=a,b.isValidReturn=!1,this.findChromeExpression(a.argument,b,c);case"ObjectExpressions":b.isReturn=!0,b.isValidReturn=!1;for(var d=0;d<a.properties.length;d++)if(this.findChromeExpression(a.properties[d].value,this.removeObjLink(b),c))return!0}return!1},a.generateOnError=function(a){return function(b,c){a[c]?a[c].push(b):a[c]=[b]}},a.replaceChromeCalls=function(a,b,c){var d=new window.TernFile("[doc]");d.text=a.join("\n");var e=new window.CodeMirror.TernServer({defs:[window.ecma5,window.ecma6,window.browserDefs]});window.tern.withContext(e.cx,function(){d.ast=window.tern.parse(d.text,e.passes,{directSourceFile:d,allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,ecmaVersion:e.ecmaVersion})});for(var f=d.ast.body,g=0,h=[],i=0;i<a.length;i++)h.push({start:g,end:g+=a[i].length+1});var j,k=d.text,l={lines:a,lineSeperators:h,script:k,passes:b};if(0===b){l.diagnostic=!0;for(var i=0;i<f.length;i++)j=f[i],this.findChromeExpression(j,{persistent:l},c);l.diagnostic=!1}for(var i=0;i<f.length;i++)if(j=f[i],this.findChromeExpression(j,{persistent:l},c)){k=this.replaceChromeCalls(l.lines.join("\n").split("\n"),b+1,c);break}return k},a.removePositionDuplicates=function(a){var b=[];return a.forEach(function(a,c){b[c]=JSON.stringify(a)}),b=b.filter(function(a,c){return b.indexOf(a)===c}),b.map(function(a){return JSON.parse(a)})},a.replace=function(a,b){var c=a.indexOf("/*execute locally*/");c!==-1&&(a=a.replace("/*execute locally*/\n",""),c===a.indexOf("/*execute locally*/")&&(a=a.replace("/*execute locally*/","")));var d=[];try{a=this.replaceChromeCalls(a.split("\n"),0,this.generateOnError(d))}catch(c){return b(null,null,!0),a}var e=d[0],f=d[d.length-1];return f&&b(this.removePositionDuplicates(e),this.removePositionDuplicates(f)),a},a}(),_a),CA.listeners=function(){function a(){}return a._toggleBugReportingTool=function(){window.errorReportingTool.toggleVisibility()},a.toggleToolsRibbon=function(){window.app.storageLocal.hideToolsRibbon?($(window.doc.editorToolsRibbonContainer).animate({marginLeft:0},250),window.doc.showHideToolsRibbonButton.style.transform="rotate(180deg)"):($(window.doc.editorToolsRibbonContainer).animate({marginLeft:"-200px"},250),window.doc.showHideToolsRibbonButton.style.transform="rotate(0deg)"),window.app.storageLocal.hideToolsRibbon=!window.app.storageLocal.hideToolsRibbon,window.app.upload()},a.launchSearchWebsiteTool=function(){if(this.parent().item&&"script"===this.parent().item.type&&window.scriptEdit){var a=this.parent().$.paperSearchWebsiteDialog;a.init(),a.show()}},a.launchExternalEditorDialog=function(){window.doc.externalEditorDialogTrigger.disabled||(window.externalEditor.init(),window.externalEditor.editingCRMItem=window.scriptEdit&&window.scriptEdit.active?window.scriptEdit.item:window.stylesheetEdit.item,window.externalEditor.setupExternalEditing())},a.runJsLint=function(){window.scriptEdit.editor.performLint()},a.runCssLint=function(){window.stylesheetEdit.editor.performLint()},a.showCssTips=function(){window.doc.cssEditorInfoDialog.open()},a.showManagePermissions=function(){this.parent().requestPermissions([],!0)},a.iconSwitch=function(a,b){var c,d,e=this.parent().crmType;if("number"==typeof b)for(c=0;c<6;c++)if(d=document.querySelectorAll(".crmType").item(c),c===b){d.style.boxShadow="inset 0 5px 10px rgba(0,0,0,0.4)",d.style.backgroundColor="rgb(243,243,243)",d.classList.add("toggled");var f=document.createElement("div");5===c?f.classList.add("crmTypeShadowMagicElementRight"):f.classList.add("crmTypeShadowMagicElement"),d.appendChild(f),e=c}else d.style.boxShadow="none",d.style.backgroundColor="white",d.classList.remove("toggled"),$(d).find(".crmTypeShadowMagicElement, .crmTypeShadowMagicElementRight").remove();else{var g=this.parent().util.findElementWithClassName(a.path,"crmType"),h=document.querySelectorAll(".crmType");for(c=0;c<6;c++)if(d=h.item(c),d===g){d.style.boxShadow="inset 0 5px 10px rgba(0,0,0,0.4)",d.style.backgroundColor="rgb(243,243,243)",d.classList.add("toggled");var f=document.createElement("div");5===c?f.classList.add("crmTypeShadowMagicElementRight"):f.classList.add("crmTypeShadowMagicElement"),d.appendChild(f),e=c}else d.style.boxShadow="none",d.style.backgroundColor="white",d.classList.remove("toggled"),$(d).find(".crmTypeShadowMagicElement, .crmTypeShadowMagicElementRight").remove()}chrome.storage.local.set({selectedCrmType:e}),this.parent().crmType!==e&&(this.parent().crmType=e,this.parent().fire("crmTypeChanged",{}))},a._generateRegexFile=function(){var a=this.parent().$.URISchemeFilePath.querySelector("input").value.replace(/\\/g,"\\\\"),b=this.parent().$.URISchemeSchemeName.querySelector("input").value,c=["Windows Registry Editor Version 5.00","","[HKEY_CLASSES_ROOT\\"+b+"]",'@="URL:'+b+' Protocol"','"URL Protocol"=""',"","[HKEY_CLASSES_ROOT\\"+b+"\\shell]","","[HKEY_CLASSES_ROOT\\"+b+"\\shell\\open]","","[HKEY_CLASSES_ROOT\\"+b+"\\shell\\open\\command]",'@="\\"'+a+'\\""'].join("\n");chrome.permissions.contains({permissions:["downloads"]},function(a){a?chrome.downloads.download({url:"data:text/plain;charset=utf-8;base64,"+window.btoa(c),filename:b+".reg"}):chrome.permissions.request({permissions:["downloads"]},function(){chrome.downloads.download({url:"data:text/plain;charset=utf-8;base64,"+window.btoa(c),filename:b+".reg"})})})},a.globalExcludeChange=function(a){for(var b=this.parent().util.findElementWithTagname(a.path,"paper-input"),c=null,d=document.getElementsByClassName("globalExcludeContainer"),e=0;e<d.length;e++)if(d[e]===b.parentNode){c=e;break}if(null!==c){var f=b.value;this.parent().globalExcludes[c]=f,this.parent().set("globalExcludes",this.parent().globalExcludes),chrome.storage.local.set({globalExcludes:this.parent().globalExcludes})}},a.removeGlobalExclude=function(a){for(var b=this.parent().util.findElementWithTagname(a.path,"paper-icon-button"),c=null,d=document.getElementsByClassName("globalExcludeContainer"),e=0;e<d.length;e++)if(d[e]===b.parentNode){c=e;break}null!==c&&this.parent().splice("globalExcludes",c,1)},a.importData=function(){var a=this,b=this.parent().$.importSettingsInput.value;if(this.parent().$.oldCRMImport.checked)try{var c=b.split("%146%");if("all"===c[0]){this.parent().storageLocal.showOptions=c[2];var d=c.slice(6),e=function(){function a(){}return a.prototype.getItem=function(a){return"numberofrows"===a?""+(d.length-1):d[a]},a}(),f=this.parent().transferCRMFromOld(c[4],new e);this.parent().settings.crm=f,this.parent().editCRM.build({superquick:!0}),this.parent().upload()}else alert("This method of importing no longer works, please export all your settings instead")}catch(a){return console.log(a),void(this.parent().$.importSettingsError.style.display="block")}else{var g=void 0;try{g=JSON.parse(b),this.parent().$.importSettingsError.style.display="none"}catch(a){return console.log(a),void(this.parent().$.importSettingsError.style.display="block")}var h=this.parent().$.overWriteImport;h.checked&&(g.local||g.storageLocal)&&(this.parent().settings=g.nonLocal||this.parent().settings,this.parent().storageLocal=g.local||this.parent().storageLocal),g.crm&&(h.checked?this.parent().settings.crm=this.parent().util.crmForEach(g.crm,function(b){b.id=a.parent().generateItemId()}):this.parent().addImportedNodes(g.crm),this.parent().editCRM.build({superquick:!0})),this.parent().upload()}},a.exportData=function(){var a=this,b={};if(this.parent().$.exportCRM.checked){b.crm=JSON.parse(JSON.stringify(this.parent().settings.crm));for(var c=0;c<b.crm.length;c++)b.crm[c]=this.parent().editCRM.makeNodeSafe(b.crm[c])}this.parent().$.exportSettings.checked&&(b.local=this.parent().storageLocal,b.nonLocal=JSON.parse(JSON.stringify(this.parent().settings)),delete b.nonLocal.crm),window.doc.exportSettingsSpinner.hide=!1,window.setTimeout(function(){a.parent().$.exportSettingsOutput.value=JSON.stringify(b),window.requestAnimationFrame(function(){window.doc.exportSettingsSpinner.hide=!0})},100)},a.addGlobalExcludeField=function(){this.parent().push("globalExcludes","")},a._openLogging=function(){window.open(chrome.runtime.getURL("html/logging.html"),"_blank")},a.hideGenericToast=function(){this.parent().$.messageToast.hide()},a.nextUpdatedScript=function(){var a=this.parent().$.scriptUpdatesToast.index;this.parent().$.scriptUpdatesToast.text=this.parent()._getUpdatedScriptString(this.parent().$.scriptUpdatesToast.scripts[++a]),this.parent().$.scriptUpdatesToast.index=a,this.parent().$.scriptUpdatesToast.scripts.length-a>1?this.parent().$.nextScriptUpdateButton.style.display="inline":this.parent().$.nextScriptUpdateButton.style.display="none"},a.hideScriptUpdatesToast=function(){this.parent().$.scriptUpdatesToast.hide()},a.copyFromElement=function(a,b){var c=document.createRange();c.selectNode(a);var d=window.getSelection();d.removeAllRanges(),d.addRange(c);try{document.execCommand("copy"),b.icon="done"}catch(a){console.error(a),b.icon="error"}this.parent().async(function(){b.icon="content-copy"},1e3),d.removeAllRanges()},a.copyExportDialogToClipboard=function(){this.copyFromElement(this.parent().$.exportJSONData,this.parent().$.dialogCopyButton)},a.copyExportToClipboard=function(){this.copyFromElement(this.parent().$.exportSettingsOutput,this.parent().$.exportCopyButton)},a.goNextVersionUpdateTab=function(){if(4===this.parent().versionUpdateTab)this.parent().$.versionUpdateDialog.close();else{var a=this.parent().versionUpdateTab+1,b=document.getElementsByClassName("versionUpdateTab"),c=b[a];c.style.height="auto";var d=void 0;for(d=0;d<b.length;d++)b[d].style.display="none";var e=$(c).innerHeight();for(d=0;d<b.length;d++)b[d].style.display="block";c.style.height="0";var f=this,g=e+"px",h=this.parent().$.versionUpdateTabSlider,i=h.getBoundingClientRect().height;e>i?h.animate([{height:i+"px"},{height:g}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"}).onfinish=function(){h.style.height=g,c.style.height="auto",f.parent().versionUpdateTab=a}:(c.style.height="auto",f.parent().versionUpdateTab=a,setTimeout(function(){h.animate([{height:i+"px"},{height:g}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"}).onfinish=function(){h.style.height=g}},500))}},a.goPrevVersionUpdateTab=function(){if(0!==this.parent().versionUpdateTab){var a=this.parent().versionUpdateTab-1,b=document.getElementsByClassName("versionUpdateTab"),c=b[a];c.style.height="auto";var d=void 0;for(d=0;d<b.length;d++)b[d].style.display="none";var e=$(c).innerHeight();for(d=0;d<b.length;d++)b[d].style.display="block";c.style.height="0";var f=this,g=e+"px",h=this.parent().$.versionUpdateTabSlider,i=h.getBoundingClientRect().height;e>i?h.animate([{height:i+"px"},{height:g}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"}).onfinish=function(){h.style.height=g,c.style.height="auto",f.parent().versionUpdateTab=a}:(c.style.height="auto",f.parent().versionUpdateTab=a,setTimeout(function(){h.animate([{height:i+"px"},{height:g}],{duration:500,easing:"cubic-bezier(0.215, 0.610, 0.355, 1.000)"}).onfinish=function(){h.style.height=g}},500))}},a._applyAddedPermissions=function(){var a=this,b=Array.prototype.slice.apply(window.doc.addedPermissionsTabContainer.querySelectorAll(".nodeAddedPermissionsCont"));b.forEach(function(b){var c=a.parent().nodesById[b.getAttribute("data-id")],d=Array.prototype.slice.apply(b.querySelectorAll("paper-checkbox")).map(function(a){return a.checked?a.getAttribute("data-permission"):null}).filter(function(a){return!!a});Array.isArray(c.permissions)||(c.permissions=[]),d.forEach(function(a){c.permissions.indexOf(a)===-1&&c.permissions.push(a)})}),this.parent().upload()},a.addedPermissionNext=function(){var a=window.doc.addedPermissionsTabContainer;return a.tab===a.maxTabs-1?(window.doc.addedPermissionsDialog.close(),void this._applyAddedPermissions()):(a.tab+2!==a.maxTabs?(window.doc.addedPermissionNextButton.querySelector(".close").style.display="none",window.doc.addedPermissionNextButton.querySelector(".next").style.display="block"):(window.doc.addedPermissionNextButton.querySelector(".close").style.display="block",window.doc.addedPermissionNextButton.querySelector(".next").style.display="none"),a.style.marginLeft=++a.tab*-800+"px",void(window.doc.addedPermissionPrevButton.style.display="block"))},a.addedPermissionPrev=function(){var a=window.doc.addedPermissionsTabContainer;a.style.marginLeft=--a.tab*-800+"px",window.doc.addedPermissionPrevButton.style.display=0===a.tab?"none":"block"},a._getCodeSettingsFromDialog=function(){var a=this,b={};return Array.prototype.slice.apply(this.parent().querySelectorAll(".codeSettingSetting")).forEach(function(c){var d,e=c.getAttribute("data-key"),f=c.getAttribute("data-type"),g=a.parent().$.codeSettingsDialog.item.value.options[e];switch(f){case"number":d=a.parent().templates.mergeObjects(g,{value:~~c.querySelector("paper-input").value});break;case"string":d=a.parent().templates.mergeObjects(g,{value:c.querySelector("paper-input").value});break;case"boolean":d=a.parent().templates.mergeObjects(g,{value:c.querySelector("paper-checkbox").checked});break;case"choice":d=a.parent().templates.mergeObjects(g,{selected:c.querySelector("paper-dropdown-menu").selected});break;case"array":var h=c.querySelector("paper-array-input");h.saveSettings();var i=h.values;i="string"===g.items?i.map(function(a){return a+""}):i.map(function(a){return~~a}),d=a.parent().templates.mergeObjects(g,{value:i})}b[e]=d}),b},a.confirmCodeSettings=function(){this.parent().$.codeSettingsDialog.item.value.options=this._getCodeSettingsFromDialog(),this.parent().upload()},a._getLocalStorageKey=function(a){var b=localStorage.getItem(a);return void 0!==b&&null!==b&&b},a.exportToLegacy=function(){for(var a=["all",this._getLocalStorageKey("firsttime"),this._getLocalStorageKey("options"),this._getLocalStorageKey("firsttime"),this._getLocalStorageKey("firsttime"),this._getLocalStorageKey("firsttime"),localStorage.getItem("optionson"),localStorage.getItem("waitforsearch"),localStorage.getItem("whatpage"),localStorage.getItem("numberofrows")].join("%146%"),b=localStorage.getItem("numberofrows")||0,c=1;c<=b;c++)a+="%146%"+localStorage.getItem(c+"");window.doc.exportToLegacyOutput.value=a},a.parent=function(){return window.app},a}(),CA.templates=function(){function a(){}return a.mergeArrays=function(a,b){for(var c=0;c<b.length;c++)a[c]&&"object"==typeof b[c]&&void 0!==a[c]&&null!==a[c]?Array.isArray(b[c])?a[c]=this.mergeArrays(a[c],b[c]):a[c]=this.mergeObjects(a[c],b[c]):a[c]=b[c];return a},a.mergeObjects=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==typeof b[c]&&"object"==typeof a[c]&&void 0!==a[c]&&null!==a[c]?Array.isArray(b[c])?a[c]=this.mergeArrays(a[c],b[c]):a[c]=this.mergeObjects(a[c],b[c]):a[c]=b[c]);return a},a.mergeObjectsWithoutAssignment=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==typeof b[c]&&void 0!==a[c]&&null!==a[c]?Array.isArray(b[c])?this.mergeArrays(a[c],b[c]):this.mergeObjects(a[c],b[c]):a[c]=b[c])},a.getDefaultNodeInfo=function(a){void 0===a&&(a={});var b={permissions:[],installDate:(new Date).toLocaleDateString(),lastUpdatedAt:Date.now(),version:"1.0",isRoot:!1,source:"local"};return this.mergeObjects(b,a)},a.getDefaultLinkNode=function(a){void 0===a&&(a={});var b={name:"name",onContentTypes:[!0,!0,!0,!1,!1,!1],type:"link",showOnSpecified:!1,nodeInfo:this.getDefaultNodeInfo(a.nodeInfo),triggers:[{url:"*://*.example.com/*",not:!1}],isLocal:!0,value:[{newTab:!0,url:"https://www.example.com"}]};return this.mergeObjects(b,a)},a.getDefaultStylesheetValue=function(a){void 0===a&&(a={});var b={stylesheet:[].join("\n"),launchMode:0,toggle:!1,defaultOn:!1,options:{},convertedStylesheet:null};return this.mergeObjects(b,a)},a.getDefaultScriptValue=function(a){void 0===a&&(a={});var b={launchMode:0,backgroundLibraries:[],libraries:[],script:[].join("\n"),backgroundScript:"",metaTags:{},options:{}};return this.mergeObjects(b,a)},a.getDefaultScriptNode=function(a){void 0===a&&(a={});var b={name:"name",onContentTypes:[!0,!0,!0,!1,!1,!1],type:"script",isLocal:!0,nodeInfo:this.getDefaultNodeInfo(a.nodeInfo),triggers:[{url:"*://*.example.com/*",not:!1}],value:this.getDefaultScriptValue(a.value)};return this.mergeObjects(b,a)},a.getDefaultStylesheetNode=function(a){void 0===a&&(a={});var b={name:"name",onContentTypes:[!0,!0,!0,!1,!1,!1],type:"stylesheet",isLocal:!0,nodeInfo:this.getDefaultNodeInfo(a.nodeInfo),triggers:[{url:"*://*.example.com/*",not:!1}],value:this.getDefaultStylesheetValue(a.value)};return this.mergeObjects(b,a)},a.getDefaultDividerOrMenuNode=function(a,b){void 0===a&&(a={});var c={name:"name",type:b,nodeInfo:this.getDefaultNodeInfo(a.nodeInfo),onContentTypes:[!0,!0,!0,!1,!1,!1],isLocal:!0,value:null};return this.mergeObjects(c,a)},a.getDefaultDividerNode=function(a){return void 0===a&&(a={}),this.getDefaultDividerOrMenuNode(a,"divider")},a.getDefaultMenuNode=function(a){return void 0===a&&(a={}),this.getDefaultDividerOrMenuNode(a,"menu")},a.getPermissions=function(){return["alarms","activeTab","background","bookmarks","browsingData","clipboardRead","clipboardWrite","contentSettings","cookies","contentSettings","contextMenus","declarativeContent","desktopCapture","downloads","history","identity","idle","management","pageCapture","power","privacy","printerProvider","sessions","system.cpu","system.memory","system.storage","topSites","tabs","tabCapture","tts","webNavigation","webRequest","webRequestBlocking"]},a.getScriptPermissions=function(){return["alarms","activeTab","background","bookmarks","browsingData","clipboardRead","clipboardWrite","contentSettings","cookies","contentSettings","contextMenus","declarativeContent","desktopCapture","downloads","history","identity","idle","management","pageCapture","power","privacy","printerProvider","sessions","system.cpu","system.memory","system.storage","topSites","tabs","tabCapture","tts","webNavigation","webRequest","webRequestBlocking","crmGet","crmWrite","chrome","GM_info","GM_deleteValue","GM_getValue","GM_listValues","GM_setValue","GM_getResourceText","GM_getResourceURL","GM_addStyle","GM_log","GM_openInTab","GM_registerMenuCommand","GM_setClipboard","GM_xmlhttpRequest","unsafeWindow"]},a.getPermissionDescription=function(a){var b={alarms:"Makes it possible to create, view and remove alarms.",activeTab:"Gives temporary access to the tab on which browserActions or contextmenu items are clicked",background:"Runs the extension in the background even while chrome is closed. (https://developer.chrome.com/extensions/alarms)",bookmarks:"Makes it possible to create, edit, remove and view all your bookmarks.",browsingData:"Makes it possible to remove any saved data on your browser at specified time allowing the user to delete any history, saved passwords, cookies, cache and basically anything that is not saved in incognito mode but is in regular mode. This is editable so it is possible to delete ONLY your history and not the rest for example. (https://developer.chrome.com/extensions/bookmarks)",clipboardRead:"Allows reading of the users' clipboard",clipboardWrite:"Allows writing data to the users' clipboard",cookies:"Allows for the setting, getting and listenting for changes of cookies on any website. (https://developer.chrome.com/extensions/cookies)",contentSettings:"Allows changing or reading your browser settings to allow or deny things like javascript, plugins, popups, notifications or other things you can choose to accept or deny on a per-site basis. (https://developer.chrome.com/extensions/contentSettings)",contextMenus:"Allows for the changing of the chrome contextmenu",declarativeContent:"Allows for the running of scripts on pages based on their url and CSS contents. (https://developer.chrome.com/extensions/declarativeContent)",desktopCapture:"Makes it possible to capture your screen, current tab or chrome window (https://developer.chrome.com/extensions/desktopCapture)",downloads:"Allows for the creating, pausing, searching and removing of downloads and listening for any downloads happenng. (https://developer.chrome.com/extensions/downloads)",history:"Makes it possible to read your history and remove/add specific urls. This can also be used to search your history and to see howmany times you visited given website. (https://developer.chrome.com/extensions/history)",identity:"Allows for the API to ask you to provide your (google) identity to the script using oauth2, allowing you to pull data from lots of google APIs: calendar, contacts, custom search, drive, gmail, google maps, google+, url shortener (https://developer.chrome.com/extensions/identity)",idle:"Allows a script to detect whether your pc is in a locked, idle or active state. (https://developer.chrome.com/extensions/idle)",management:"Allows for a script to uninstall or get information about an extension you installed, this does not however give permission to install other extensions. (https://developer.chrome.com/extensions/management)",notifications:"Allows for the creating of notifications. (https://developer.chrome.com/extensions/notifications)",pageCapture:"Allows for the saving of any page in MHTML. (https://developer.chrome.com/extensions/pageCapture)",power:"Allows for a script to keep either your screen or your system altogether from sleeping. (https://developer.chrome.com/extensions/power)",privacy:"Allows for a script to query what privacy features are on/off, for exaple autoFill, password saving, the translation feature. (https://developer.chrome.com/extensions/privacy)",printerProvider:"Allows for a script to capture your print jobs' content and the printer used. (https://developer.chrome.com/extensions/printerProvider)",sessions:"Makes it possible for a script to get all recently closed pages and devices connected to sync, also allows it to re-open those closed pages. (https://developer.chrome.com/extensions/sessions)","system.cpu":"Allows a script to get info about the CPU. (https://developer.chrome.com/extensions/system_cpu)","system.memory":"Allows a script to get info about the amount of RAM memory on your computer. (https://developer.chrome.com/extensions/system_memory)","system.storage":"Allows a script to get info about the amount of storage on your computer and be notified when external storage is attached or detached. (https://developer.chrome.com/extensions/system_storage)",topSites:"Allows a script to your top sites, which are the sites on your new tab screen. (https://developer.chrome.com/extensions/topSites)",tabCapture:"Allows the capturing of the CURRENT tab and only the tab. (https://developer.chrome.com/extensions/tabCapture)",tabs:"Allows for the opening, closing and getting of tabs",tts:"Allows a script to use chrome's text so speach engine. (https://developer.chrome.com/extensions/tts)",webNavigation:"Allows a script info about newly created pages and allows it to get info about what website visit at that time. (https://developer.chrome.com/extensions/webNavigation)",webRequest:"Allows a script info about newly created pages and allows it to get info about what website you are visiting, what resources are downloaded on the side, and can basically track the entire process of opening a new website. (https://developer.chrome.com/extensions/webRequest)",webRequestBlocking:"Allows a script info about newly created pages and allows it to get info about what website you are visiting, what resources are downloaded on the side, and can basically track the entire process of opening a new website. This also allows the script to block certain requests for example for blocking ads or bad sites. (https://developer.chrome.com/extensions/webRequest)",crmGet:"Allows the reading of your Custom Right-Click Menu, including names, contents of all nodes, what they do and some metadata for the nodes",crmWrite:"Allows the writing of data and nodes to your Custom Right-Click Menu. This includes <b>creating</b>, <b>copying</b> and <b>deleting</b> nodes. Be very careful with this permission as it can be used to just copy nodes until your CRM is full and delete any nodes you had. It also allows changing current values in the CRM such as names, actual scripts in script-nodes etc.",chrome:"Allows the use of chrome API's. Without this permission only the 'crmGet' and 'crmWrite' permissions will work.",GM_addStyle:"Allows the adding of certain styles to the document through this API",GM_deleteValue:"Allows the deletion of storage items",GM_listValues:"Allows the listing of all storage data",GM_addValueChangeListener:"Allows for the listening of changes to the storage area",GM_removeValueChangeListener:"Allows for the removing of listeners",GM_setValue:"Allows for the setting of storage data values",GM_getValue:"Allows the reading of values from the storage",GM_log:"Allows for the logging of values to the console (same as normal console.log)",GM_getResourceText:"Allows the reading of the content of resources defined in the header",GM_getResourceURL:"Allows the reading of the URL of the predeclared resource",GM_registerMenuCommand:"Allows the adding of a button to the extension menu - not implemented",GM_unregisterMenuCommand:"Allows the removing of an added button - not implemented",GM_openInTab:"Allows the opening of a tab with given URL",GM_xmlhttpRequest:"Allows you to make an XHR to any site you want",GM_download:"Allows the downloading of data to the hard disk",GM_getTab:"Allows the reading of an object that's persistent while the tab is open - not implemented",GM_saveTab:"Allows the saving of the tab object to reopen after a page unload - not implemented",GM_getTabs:"Allows the reading of all tab object - not implemented",GM_notification:"Allows sending desktop notifications",GM_setClipboard:"Allows copying data to the clipboard - not implemented",GM_info:"Allows the reading of some script info",unsafeWindow:"Allows the running on an unsafe window object - available by default"};return b[a]},a.parent=function(){return window.app},a}(),CA.pageDemo=(_b=function(){function a(){}return a.isNodeVisible=function(a,b){var c,d;if(a.children&&a.children.length>0){d=a.children.length;var e=0;for(c=0;c<d;c++)e+=this.isNodeVisible(a.children[c],b);if(!e)return 0}else for(c=0;c<6;c++)if(b===c&&!a.onContentTypes[c])return 0;return 1},a.buildForCrmType=function(a){var b=this,c={num:0},d={},e=window.app.settings.crm;return e.forEach(function(e){if(b.isNodeVisible(e,a))if(b.parent().storageLocal.editCRMInRM&&"divider"!==e.type&&"menu"!==e.type)d[c.num++]=b.node.editable(e);else switch(e.type){case"link":d[c.num]=b.node.link(e);break;case"script":d[c.num]=b.node.script(e);break;case"stylesheet":d[c.num]=b.node.stylesheet(e);break;case"divider":d[c.num]=b.node.divider();break;case"menu":d[c.num]=b.node.menu(e,a,c)}}),d},a.getCrmTypeFromNumber=function(a){var b=["page","link","selection","image","video","audio"];return b[a]},a.getChildrenAmount=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},a.bindContextMenu=function(a){var b,c=this;if(0===a)b=c.buildForCrmType(0),c.getChildrenAmount(b)>0&&$.contextMenu({selector:".container, #editCrm.page, .crmType.pageType",items:b});else{var d=c.getCrmTypeFromNumber(a);b=c.buildForCrmType(a),c.getChildrenAmount(b)>0&&$.contextMenu({selector:"#editCrm."+d+", .crmType."+d+"Type",items:b})}},a.removeContextMenus=function(){
var a;this.usedStylesheetIds.forEach(function(b){a=document.getElementById("stylesheet"+b),a&&a.remove()}),$.contextMenu("destroy")},a.loadContextMenus=function(){function a(d){for(;c<6&&d.timeRemaining()>0;)b.bindContextMenu(c++),window.requestIdleCallback(a)}var b=this,c=0;this.removeContextMenus();var d;if("requestIdleCallback"in window)d=window.requestIdleCallback(a);else for(;c<6;)b.bindContextMenu(c++)},a.create=function(){return $.contextMenu?void(this.parent().storageLocal.CRMOnPage&&~~/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1].split(".")[0]>34?this.loadContextMenus():this.removeContextMenus()):void window.setTimeout(this.create.bind(this),500)},a.parent=function(){return window.app},a}(),_b.usedStylesheetIds=[],_b.handlers=(_c=function(){function a(){}return a.link=function(a){return function(){for(var b=0;b<a.length;b++)window.open(a[b].url,"_blank")}},a.script=function(a){return function(){alert("This would run the script "+a)}},a.edit=function(a){var b=this;return function(){b.parent().parent().editCRM.getCRMElementFromPath(a.path,!0).openEditPage()}},a.parent=function(){return window.app.pageDemo},a}(),_c.stylesheet=function(){function a(){}return a.toggle=function(a,b){var c=b;return function(){alert("This would toggle the stylesheet "+a+" "+(c?"on":"off"))}},a.normal=function(a){return function(){alert("This would run the stylesheet "+a)}},a}(),_c),_b.node=function(){function a(){}return a.link=function(a){return{name:a.name,callback:this.parent().handlers.link(a.value)}},a.script=function(a){return{name:a.name,callback:this.parent().handlers.script(a.value.script)}},a.stylesheet=function(a){var b={name:a.name};return a.value.toggle?(b.type="checkbox",b.selected=a.value.defaultOn,b.callback=this.parent().handlers.stylesheet.toggle(a.value.stylesheet,a.value.defaultOn)):b.callback=this.parent().handlers.stylesheet.normal(a.value.stylesheet),b},a.editable=function(a){return{name:a.name,callback:this.parent().handlers.edit(a)}},a.divider=function(){return"---------"},a.menu=function(a,b,c){var d=this,e={name:a.name},f={};return d.parent().parent().storageLocal.editCRMInRM&&(e.callback=this.parent().handlers.edit(a)),a.children.forEach(function(a){if(d.parent().isNodeVisible(a,b))if(d.parent().parent().storageLocal.editCRMInRM&&"divider"!==a.type&&"menu"!==a.type)f[c.num++]=d.editable(a);else switch(a.type){case"link":f[c.num++]=d.link(a);break;case"script":f[c.num++]=d.script(a);break;case"stylesheet":f[c.num++]=d.stylesheet(a);break;case"divider":f[c.num++]=d.divider();break;case"menu":f[c.num++]=d.menu(a,b,c)}}),e.items=f,e},a.parent=function(){return window.app.pageDemo},a}(),_b),CA.crm=function(){function CRMAppCRMFunctions(){}return CRMAppCRMFunctions._getEvalPath=function(a){return"window.app.settings.crm["+a.join("].children[")+"]"},CRMAppCRMFunctions.lookup=function(path,returnArray){void 0===returnArray&&(returnArray=!1);var pathCopy=JSON.parse(JSON.stringify(path));if(returnArray&&pathCopy.splice(pathCopy.length-1,1),0===path.length)return window.app.settings.crm;if(1===path.length)return returnArray?window.app.settings.crm:window.app.settings.crm[path[0]];var evalPath=this._getEvalPath(pathCopy),result=eval(evalPath);return returnArray?result.children:result},CRMAppCRMFunctions._lookupId=function(a,b,c){var d=c.children;if(d)for(var e=void 0,f=0;f<d.length;f++){if(d[f].id===a)return b?d:c;if(e=this._lookupId(a,b,d[f]))return e}return null},CRMAppCRMFunctions.lookupId=function(a,b){if(!b)return window.app.nodesById[a];for(var c,d=0;d<window.app.settings.crm.length;d++){if(window.app.settings.crm[d].id===a)return window.app.settings.crm;if(c=this._lookupId(a,b,window.app.settings.crm[d]))return c}return null},CRMAppCRMFunctions.add=function(a,b){void 0===b&&(b="last"),"first"===b?this.parent().settings.crm=this.parent().util.insertInto(a,this.parent().settings.crm,0):"last"===b||void 0===b?this.parent().settings.crm[this.parent().settings.crm.length]=a:this.parent().settings.crm=this.parent().util.insertInto(a,this.parent().settings.crm),window.app.upload(),window.app.editCRM.build({setItems:window.app.editCRM.setMenus,superquick:!0})},CRMAppCRMFunctions.move=function(a,b,c){var d=this.lookup(a,!0),e=a[a.length-1],f=d[e],g=this.lookup(b,!0),h=b[b.length-1];c&&e>h?(this.parent().util.insertInto(f,g,h),d.splice(~~e+1,1)):(this.parent().util.insertInto(f,g,h),d.splice(e,1)),window.app.upload(),window.app.editCRM.build({setItems:window.app.editCRM.setMenus,quick:!0})},CRMAppCRMFunctions.parent=function(){return window.app},CRMAppCRMFunctions}(),CA.util=function(){function a(){}return a.waitFor=function(a,b,c){a[b]&&c(a[b]);var d=window.setInterval(function(){a[b]&&(window.clearInterval(d),c(a[b]))},10)},a.createElement=function(a,b,c){void 0===c&&(c=[]);var d=document.createElement(a);if(b.id&&(d.id=b.id),b.classes&&d.classList.add.apply(d.classList,b.classes),b.props)for(var e in b.props)d.setAttribute(e,b.props[e]);for(var f=0;f<c.length;f++){var g=c[f];"string"==typeof g?d.innerText=g:d.appendChild(g)}return d},a.findElementWithTagname=function(a,b){for(var c=0,d=a[0];d.tagName.toLowerCase()!==b;)if(d=a[++c],c>a.length)return null;return d},a.findElementWithClassName=function(a,b){for(var c=0,d=a[0];!d.classList.contains(b);)if(d=a[++c],c>a.length)return null;return d},a.insertInto=function(a,b,c){if(void 0===c&&(c=null),c){var d=void 0,e=void 0,f=a;for(e=c;e<b.length;e++)d=b[e],b[e]=f,f=d;b[e]=f}else b.push(a);return b},a.compareObj=function(a,b){if(!b)return!a;if(!a)return!1;for(var c in a)if(a.hasOwnProperty(c))if("object"==typeof a[c]){if("object"!=typeof b[c])return!1;if(Array.isArray(a[c])){if(!Array.isArray(b[c]))return!1;if(!this.compareArray(a[c],b[c]))return!1}else{if(Array.isArray(b[c]))return!1;if(!this.compareObj(a[c],b[c]))return!1}}else if(a[c]!==b[c])return!1;return!0},a.compareArray=function(a,b){if(!a!=!b)return!1;if(!a||!b)return!1;var c=a.length;if(c!==b.length)return!1;var d;for(d=0;d<c;d++)if("object"==typeof a[d]){if("object"!=typeof b[d])return!1;if(Array.isArray(a[d])){if(!Array.isArray(b[d]))return!1;if(!this.compareArray(a[d],b[d]))return!1}else{if(Array.isArray(b[d]))return!1;if(!this.compareObj(a[d],b[d]))return!1}}else if(a[d]!==b[d])return!1;return!0},a.treeForEach=function(a,b){if(b(a),a.children)for(var c=0;c<a.children.length;c++)this.treeForEach(a.children[c],b)},a.crmForEach=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];"menu"===d.type&&d.children&&this.crmForEach(d.children,b),b(d)}return a},a.parent=function(){return window.app},a}(),Polymer(CA);var _a,_b,_c;